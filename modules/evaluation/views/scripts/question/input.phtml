<div>
	<?php if( isset( $this->evaluation_id ) && $this->evaluation_id ):?>
		<div class="right">
			<?=$this->ajax( $this->translate( 'import database of questions' ) , "bank-question" , "$this->url/evaluation/question/bank-question/tpl/ajax" )?>
		</div>
	<?php endif;?>
    <div>
        <form id="QuestionValidate" method="post">
            <?=$this->formHidden( "id" , $this->data->id , array( "printLabel" => false ) )?>

            <div class="left">
                <label for="type_<?=$this->suffix?>"><?=$this->translate( 'select the type of question' )?></label>
                <?=$this->formSelect( "type" , $this->data->type , array( "id" => "type_" . $this->suffix ) , $this->types )?>
            </div>

            <div class="left" style="margin-left: 65px;">
                <label for="theme_<?=$this->suffix?>"><?=$this->translate( 'ticket' )?>:</label>
                <?=$this->formText( "theme" , $this->data->theme , array( "id" => "theme_" . $this->suffix , "style" => "width: 359px;" ) )?><br />
                <span style="font-size: 11px;">Escreva os termos pelos quais você deseja resgatar a questão.</span>
            </div>
			
            <div class="clear">&nbsp;</div>
            
            <div>
                <label for="<?="$this->model-label"?>"><span style="color: red">*</span> <?=$this->translate( 'question comand' )?></label>
				<?php if( isset( $this->data->label ) && $this->data->label && !$this->data->labels ):?>
					<?=$this->formTextarea( "labels" , $this->data->label , array( "id" => "label_" . $this->suffix ) )?>
				<?php else:?>
					<?=$this->formTextarea( "labels" , $this->data->labels , array( "id" => "label_" . $this->suffix ) )?>
				<?php endif;?>
                
            </div>

            <div class="clear">&nbsp;</div>

            <div id="message-validate"></div>
            <div id="questions-create"></div>
            
            <br /><br />

            <input type="submit" id="submitQuestion" value="<?=$this->translate( 'save' )?>" />
        </form>
    </div>

    <div id="bank-question"></div>
</div>
<script type="text/javascript">
    <?php if( isset( $this->data->id ) && $this->data->id ):?>
        new Preceptor.util.AjaxUpdate( "questions-create" , "<?=$this->url?>/evaluation/question/types/type/<?=$this->data->type?>/id/<?=$this->data->id?>" );
    <?php endif;?>

    /**
     * created var for validate inputs type radio and checkbox;
     *
     * can take the value boolean
     */
     window.validate_q = false;

    /**
     * created validation
     */
    window.QuestionValidate = new Preceptor.util.Validate();
	
    /**
     * clean text of the validade, id 'message-validate';
     * clean messages and validates of the var QuestionValidate;
     * does the requisition AJAX for type selected;
     */
    jQuery( "#type_<?=$this->suffix?>" ).change( function(){
        jQuery( "#message-validate" ).html( "" ).removeAttr( "style" );
        //window.QuestionValidate.clear();
        
        validate_q = false;
		
		$( "questions-create" ).innerHTML = "";
		
        if( this.value ){
            new Preceptor.util.AjaxUpdate( "questions-create" , "<?=$this->url?>/evaluation/question/types/type/" + this.value )
        }
    });

    /**
     * created var for editor
     */
    var Editor_Question = new Preceptor.widget.Editor( "label_<?=$this->suffix?>" , { addButton:['insertHtml'] , height: '80px' } );

    /**
     * save question
    */
	jQuery( "#QuestionValidate" ).submit( function(){
		if( window.QuestionValidate.verify( document.getElementById('QuestionValidate') ) ){
			Editor_Question.saveHTML();
			if( window.validate_q ){ 
				new Preceptor.util.AjaxUpdate( "evaluation" , "<?=$this->url?>/evaluation/question/save/" , {formId: 'QuestionValidate'} );
				window.validate_q = false;
			}
		}
		return false;
	});    
</script>